(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ef5a6fac"],{3227:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mainmiddleupload"},[i("div",{staticClass:"upload"},[i("div",{staticClass:"upload-header"},[i("div",{staticClass:"upload-header-protrait"},[i("img",{attrs:{src:t.protrait,alt:"网络错误，无法显示图片！"}})]),i("div",{staticClass:"upload-header-username"},[t._v(t._s(t.username))])]),i("div",{staticClass:"upload-body"},[i("div",{staticClass:"upload-body-contents"},[i("textarea",{directives:[{name:"model",rawName:"v-model.trim.lazy",value:t.textareaValue,expression:"textareaValue",modifiers:{trim:!0,lazy:!0}}],ref:"myTextarea",attrs:{name:"uploadContents",id:"upload-contents-area",placeholder:"编辑你的微博吧！"},domProps:{value:t.textareaValue},on:{change:[function(e){t.textareaValue=e.target.value.trim()},t.sendWeiboDataWhenTextareaChange],blur:function(e){return t.$forceUpdate()}}})]),i("div",{ref:"myUploadBodyPics",staticClass:"upload-body-pics"},t._l(t.picsDataList,(function(e){return i("div",{key:e.imgId,staticClass:"upload-body-pics-num"},[i("div",{staticClass:"icon-arrow-left2",on:{click:function(i){return t.moveLeft(e.imgId)},mouseenter:function(e){return t.arrowLeftMouseEnter(e)},mouseleave:function(e){return t.arrowLeftMouseLeave(e)}}}),i("div",{staticClass:"icon-arrow-right2",on:{click:function(i){return t.moveRight(e.imgId)},mouseenter:function(e){return t.arrowRightMouseEnter(e)},mouseleave:function(e){return t.arrowRightMouseLeave(e)}}}),i("img",{attrs:{src:e.uploadImg,alt:"网络错误，无法显示图片！","data-flag":""+e.imgFlag},on:{click:function(e){return t.scalePic(e)},mouseenter:function(e){return t.imgMouseEnter(e)},mouseleave:function(e){return t.imgMouseLeave(e)}}}),i("input",{attrs:{type:"file",name:"uploadPic",id:"uploadPic"},on:{change:function(i){return t.uploadImgFile(i,e.imgId)}}}),i("i",{ref:"myIcon",refInFor:!0,staticClass:"icon-cross",on:{click:function(i){return t.removeImgFile(i,e.imgId)},mouseenter:function(e){return t.crossMouseEnter(e)},mouseleave:function(e){return t.crossMouseLeave(e)}}})])})),0)])])])},s=[],n=i("6b75");function r(t){if(Array.isArray(t))return Object(n["a"])(t)}var o=i("db90"),l=i("06c5");i("d9e2");function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(t){return r(t)||Object(o["a"])(t)||Object(l["a"])(t)||c()}i("d3b7"),i("a434"),i("b64b"),i("e9c4");var g=i("c65d"),p=i("70e0"),d={name:"MainMiddleUpload",data:function(){return{username:"",protrait:"",textareaValue:"",picsDataList:[{uploadImg:"",imgFlag:!1,imgId:1}],imgInitialId:1,hasSaveFlag:!0,hasContentChangeFlag:!1}},watch:{textareaValue:function(){this.hasContentChangeFlag=!0},picsDataList:function(){this.hasContentChangeFlag=!0}},methods:{arrowLeftMouseEnter:function(t){t.target.style.color="#ff8200",t.target.nextSibling.nextSibling.style.border="1px solid #ff8200"},arrowLeftMouseLeave:function(t){t.target.style.color="",t.target.nextSibling.nextSibling.style.border=""},arrowRightMouseEnter:function(t){t.target.style.color="#ff8200",t.target.nextSibling.style.border="1px solid #ff8200"},arrowRightMouseLeave:function(t){t.target.style.color="",t.target.nextSibling.style.border=""},imgMouseEnter:function(t){t.target.style.border="1px solid #ff8200"},imgMouseLeave:function(t){t.target.style.border=""},crossMouseEnter:function(t){t.target.style.color="#ff8200",t.target.previousSibling.previousSibling.style.border="1px solid #ff8200"},crossMouseLeave:function(t){t.target.style.color="",t.target.previousSibling.previousSibling.style.border=""},scalePic:function(t){g["b"].scalePic(t),t.target.style.display="block"},getDataList:function(){var t={textarea:this.textareaValue,picsDataList:this.picsDataList};p["a"].$emit("sendWeiboDataList",t)},sendWeiboDataWhenTextareaChange:function(){this.getDataList()},uploadImgFile:function(t,e){var i=this,a=this.$store.state.MYWEIBO.weiboDataAll;!0!==a[a.length-1].dataList.firstFlag&&a.every((function(t){return 0===t.dataList.picsDataList.length}))&&(this.imgInitialId=1);var s=t.target.files[0],n=new FileReader;n.readAsDataURL(s),n.onload=function(a){i.picsDataList.some((function(t){t.imgId===e&&(t.uploadImg=a.target.result)})),t.target.style.display="none",t.target.previousSibling.style.display="block",t.target.nextSibling.style.display="block",t.target.previousSibling.previousSibling.style.display="block",t.target.previousSibling.previousSibling.previousSibling.style.display="block";var s=i.picsDataList.length;if(9!==s){var n={uploadImg:"",imgFlag:!1,imgId:++i.imgInitialId};i.picsDataList.push(n),i.getDataList()}else i.getDataList()}},removeImgFile:function(t,e){var i=this;this.picsDataList.some((function(t,a){t.imgId===e&&i.picsDataList.splice(a,1)}));var a=this.picsDataList.length;if(1===a){var s=this.$store.state.MYWEIBO.weiboDataAll;!0!==s[s.length-1].dataList.firstFlag&&s.every((function(t){return 0===t.dataList.picsDataList.length}))&&(this.imgInitialId=1,this.$set(this.picsDataList[0],"imgId",1)),t.target.previousSibling.style.display="block",t.target.previousSibling.previousSibling.style.display="none",t.target.style.display="none",t.target.previousSibling.previousSibling.previousSibling.style.display="none",t.target.previousSibling.previousSibling.previousSibling.previousSibling.style.display="none"}if(8===a&&""!==this.picsDataList[this.picsDataList.length-1].uploadImg){var n={uploadImg:"",imgFlag:!1,imgId:++this.imgInitialId};this.picsDataList.push(n)}this.getDataList()},moveLeft:function(t){var e=this;this.picsDataList.some((function(i,a){if(i.imgId===t){if(0===a)return;e.picsDataList.splice(a,1),e.picsDataList.splice(a-1,0,i),e.getDataList()}}))},moveRight:function(t){var e=this;this.picsDataList.some((function(i,a){if(i.imgId===t){if(8===a)return;if(""===e.picsDataList[a+1].uploadImg)return;var s=e.picsDataList.splice(0,a),n=e.picsDataList.splice(0,1),r=e.picsDataList.splice(0,1),o=e.picsDataList.splice(0,e.picsDataList.length-1),l=e.picsDataList.splice(-1),c=[];c.push.apply(c,u(s)),c.push.apply(c,u(r)),c.push.apply(c,u(n)),c.push.apply(c,u(o)),c.push.apply(c,u(l)),e.picsDataList=c,e.getDataList()}}))}},created:function(){var t=this;p["a"].$off("getPostFlag"),p["a"].$on("getPostFlag",(function(e){t.hasSaveFlag=e}))},activated:function(){this.hasContentChangeFlag=!1,this.getDataList(),this.$refs.myTextarea.focus();var t=Object.keys(JSON.parse(JSON.stringify(sessionStorage)))[0],e=JSON.parse(localStorage.getItem(t)).protrait;this.username=t,this.protrait=e},beforeRouteLeave:function(t,e,i){if(!1===this.hasSaveFlag)this.textareaValue="",this.picsDataList.splice(0,this.picsDataList.length-1),this.hasSaveFlag=!0,i();else if(!1===this.hasContentChangeFlag)i();else{var a=confirm("是否要保存草稿?");a||(this.textareaValue="",this.picsDataList.splice(0,this.picsDataList.length-1)),i()}}},f=d,h=(i("fc80"),i("2877")),m=Object(h["a"])(f,a,s,!1,null,"2350346e",null);e["default"]=m.exports},"70e0":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var a=i("2b0e"),s=new a["a"]},c5a8:function(t,e,i){},fc80:function(t,e,i){"use strict";i("c5a8")}}]);
//# sourceMappingURL=chunk-ef5a6fac.75982047.js.map